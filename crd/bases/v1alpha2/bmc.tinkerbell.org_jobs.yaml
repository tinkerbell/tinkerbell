---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.18.0
  name: jobs.bmc.tinkerbell.org
spec:
  group: bmc.tinkerbell.org
  names:
    categories:
    - tinkerbell
    kind: Job
    listKind: JobList
    plural: jobs
    shortNames:
    - j
    singular: job
  scope: Namespaced
  versions:
  - name: v1alpha2
    schema:
      openAPIV3Schema:
        description: Job is the Schema for the bmcjobs API.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: JobSpec defines the desired state of Job.
            properties:
              bmcRef:
                description: |-
                  BMCRef represents the BMC resource to execute the job.
                  All the operations in the job are executed for the same BMC.
                properties:
                  name:
                    description: Name of the BMC.
                    type: string
                  namespace:
                    description: Namespace the BMC resides in.
                    type: string
                required:
                - name
                - namespace
                type: object
              operations:
                description: |-
                  Operations represents a list of baseboard management actions to be executed.
                  The operations are executed sequentially. Controller waits for one operation to complete before executing the next.
                  If a single operation fails, job execution stops and sets condition Failed.
                  Condition Completed is set only if all the operations were successful.
                items:
                  description: |-
                    Operations defines the operations that can be performed against a BMC.
                    Only a single field in the struct should be defined at any given time
                    as only one operation can be performed at a time.
                    For example either PowerAction or BootDevice.
                  maxProperties: 1
                  properties:
                    bootDevice:
                      description: BootDevice is the device to set as the first boot
                        device on the Machine.
                      properties:
                        device:
                          description: Device is the name of the device to set as
                            the first boot device.
                          type: string
                        efiBoot:
                          description: EFIBoot indicates whether the boot device should
                            be set to efiboot mode.
                          type: boolean
                        persistent:
                          description: Persistent indicates whether the boot device
                            should be set persistently as the first boot device.
                          type: boolean
                      type: object
                    powerAction:
                      allOf:
                      - enum:
                        - "on"
                        - "off"
                        - soft
                        - status
                        - cycle
                        - reset
                      - enum:
                        - "on"
                        - "off"
                        - soft
                        - status
                        - cycle
                        - reset
                      description: PowerAction represents a baseboard management power
                        operation.
                      type: string
                    virtualMediaAction:
                      description: VirtualMediaAction represents a baseboard management
                        virtual media insert/eject.
                      properties:
                        kind:
                          description: Kind represents the kind of virtual media.
                          type: string
                        mediaURL:
                          description: mediaURL represents the URL of the image to
                            be inserted into the virtual media, or empty to eject
                            media.
                          type: string
                      required:
                      - kind
                      type: object
                  type: object
                minItems: 1
                type: array
            required:
            - bmcRef
            - operations
            type: object
          status:
            description: JobStatus defines the observed state of Job.
            properties:
              completionTime:
                description: |-
                  CompletionTime represents time when the job was completed.
                  The completion time is only set when the job finishes successfully.
                format: date-time
                type: string
              conditions:
                description: Conditions represents the latest available observations
                  of an object's current state.
                items:
                  properties:
                    lastUpdateTime:
                      description: LastUpdateTime of the condition.
                      format: date-time
                      type: string
                    message:
                      description: Message represents human readable message indicating
                        details about last transition.
                      type: string
                    observedGeneration:
                      description: |-
                        ObservedGeneration is the generation of the Machine that was last observed by the controller.
                        It is used to determine if the condition is up to date with the latest changes.
                      format: int64
                      type: integer
                    status:
                      description: |-
                        Status is the status of the Job condition.
                        Can be True or False.
                      type: string
                    type:
                      description: Type of the Job condition.
                      type: string
                  required:
                  - status
                  - type
                  type: object
                type: array
              startTime:
                description: StartTime represents time when the Job controller started
                  processing a job.
                format: date-time
                type: string
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
